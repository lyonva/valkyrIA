# Homework 2 Report
- CSC 791 Sinless Software Engineering
- By: Leonardo Villalobos Arias

## Description
For the second homework of the class, a reader for CSV files was implemented. The reader follows the file standard defined by [professor Menzies](https://github.com/txt/sin21/blob/main/data/auto93.csv). The reader works as follows:
1. Load the contents of the specified file
2. Convert contents to a matrix structure, rows not compliant with size are removed
3. Convert each column to the type specified in the header:
   1. If name is uppercase, convert to int, float or bool
   2. If name is lowercase, leave as string
   3. if name starts with ?, still include row but ignore conversion
4. Return data as matrix: list of lists in Python

The conversor is on the [src.io](https://github.com/lyonva/valkyrIA/blob/main/src/io) package, on the [reader](https://github.com/lyonva/valkyrIA/blob/main/src/io/reader.py) file.

## Example
```python
from src.io import CSV

data = CSV.read_file("data.csv")
```

## Tests
Tests are available on [test/test_read_csv.py](https://github.com/lyonva/valkyrIA/blob/main/test/test_read_csv.py)

The code was tested on the following 3 datasets on the [data](https://github.com/lyonva/valkyrIA/data) directory: [weather](https://github.com/lyonva/valkyrIA/blob/main/data/weather.csv), [auto93](https://github.com/lyonva/valkyrIA/blob/main/data/auto93.csv), and [pom3a](https://github.com/lyonva/valkyrIA/blob/main/data/pom3a.csv). The test cases verify that the CSV reader loads the file correctly by checking the 1) size of the resulting matrix and 2) the contents of each cell. The reader was compared against the respective dataframe loader in pandas. The tests were templated as follows:

```python
data = CSV.read_file("data.csv")
true_data = pd.read_csv("data.csv")

# Check size
assert len(data) == true_data.shape[0] + 1 # +1 because our reader includes header
    for row in data:
        assert len(row) == true_data.shape[1]

# Check data
    for j in range(true_data.shape[1]):
        assert data[0][j] == header[j]
    for i in range(true_data.shape[0]):
        for j in range(true_data.shape[1]):
            assert data[i+1][j] == true_data[i][j]
```

Lastly, one \'noisy\' test was added for the pom3a.csv dataset. The test generates a temporary copy of pom3a with 5% of noisy rows. The CSV reader has to determine which rows are incorrect, and should obtain a dataset that is equal to the original one. Half of the noisy rows have the same size of the original data, so the reader is forced to type-check them.

## Results
The test were conducted by a github action for the commit [5c478a0](https://github.com/lyonva/valkyrIA/commit/5c478a0b42d3b8c6ef063b68fb3403d73ac4d6af), and the corresponding [report](https://github.com/lyonva/valkyrIA/actions/runs/1178670222) shows that all test cases passed, and includes the output generated by the CSV reader. This output includes the loading times for each dataset, as well as the errors that the reader encountered while parsing. The following table summarizes the loading times for the Python 3.9 tests:

Dataset | Time (ms)
---- | ----:
weather | 0.28
auto93 | 8.56
pom3a | 632.52
noisy pom3a | 595.07

Even though it is larger in size and requires more validation, the noisy pom3a dataset requires less processing time than pom3a. This may be due to file caching, as the new dataset is written as part of the test case.

The 4 test cases passed, showing that the CSV loader works as intended. In addition, the CSV loader identified 217 badly shaped rows and 233 rows with incorrect data types on the noisy pom3a set.
